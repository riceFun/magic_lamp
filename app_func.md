# 个人项目积分管理App - 功能设计文档

## 1. 应用概述

**应用名称**: Magic Lamp (神灯积分管理)

**核心理念**: 通过积分激励系统，帮助用户管理个人任务和项目，养成良好习惯，实现目标。

**目标用户**: 希望通过游戏化方式提升自我管理能力的个人用户

## 2. 核心功能模块

### 2.1 积分系统
- **积分展示**: 首页显示当前总积分
- **积分历史**: 查看积分变动记录（时间、类型、数量、原因）
- **积分统计**: 按时间维度统计积分获取和消耗情况（日/周/月）

### 2.2 任务管理
- **任务创建**:
  - 任务名称、描述
  - 完成奖励积分
  - 未完成惩罚积分（可选）
  - 任务类型（一次性/每日/每周/每月）
  - 截止时间/提醒时间
  - 优先级标记

- **任务操作**:
  - 标记完成（自动增加积分）
  - 标记失败（自动扣除积分）
  - 编辑任务
  - 删除任务

- **任务状态**:
  - 待完成
  - 已完成
  - 已失败
  - 已过期

### 2.3 项目管理
- **项目创建**:
  - 项目名称、描述
  - 项目图标/颜色
  - 关联任务列表

- **项目分类**: 可自定义分类（如：学习、健身、工作、生活等）
- **项目统计**: 每个项目的积分贡献统计
- **项目操作**: 编辑、删除、归档

### 2.4 积分兑换（消耗）
- **奖励库**:
  - 创建奖励项目（名称、描述、所需积分）
  - 奖励分类管理

- **兑换操作**:
  - 使用积分兑换奖励
  - 记录兑换历史
  - 显示已兑换次数

### 2.5 其他积分操作
- **手动调整**: 手动增加/减少积分（需填写原因）
- **积分罚款**: 自定义扣分项目（如：熬夜、拖延等）
- **积分奖励**: 自定义加分项目（如：早起、读书等）

## 3. 数据模型设计（SQLite）

### 3.1 表结构设计

#### projects 表（项目表）
```sql
- id (主键)
- name (项目名称)
- description (项目描述)
- icon (图标标识)
- color (颜色代码)
- category (分类)
- created_at (创建时间)
- updated_at (更新时间)
- is_archived (是否归档)
```

#### tasks 表（任务表）
```sql
- id (主键)
- project_id (关联项目ID，外键)
- title (任务标题)
- description (任务描述)
- reward_points (完成奖励积分)
- penalty_points (失败惩罚积分)
- task_type (任务类型: once/daily/weekly/monthly)
- priority (优先级: low/medium/high)
- status (状态: pending/completed/failed/expired)
- due_date (截止时间)
- remind_at (提醒时间)
- created_at (创建时间)
- completed_at (完成时间)
```

#### point_records 表（积分记录表）
```sql
- id (主键)
- type (类型: task_reward/task_penalty/exchange/manual_add/manual_deduct/custom)
- amount (积分变动量，正数为增加，负数为减少)
- reason (原因/说明)
- related_id (关联ID，如任务ID或兑换ID)
- related_type (关联类型: task/exchange/custom)
- created_at (创建时间)
```

#### rewards 表（奖励库表）
```sql
- id (主键)
- name (奖励名称)
- description (奖励描述)
- cost_points (所需积分)
- category (分类)
- is_active (是否可用)
- created_at (创建时间)
```

#### exchanges 表（兑换记录表）
```sql
- id (主键)
- reward_id (关联奖励ID，外键)
- points_spent (消耗积分)
- created_at (兑换时间)
```

## 4. 技术栈

- **前端框架**: Flutter
- **本地数据库**: SQLite (sqflite 包)
- **状态管理**: Provider / Riverpod / GetX（待定）
- **本地存储**: shared_preferences（用户设置）
- **通知提醒**: flutter_local_notifications（可选）

## 5. 待确认的功能细节

### 5.1 用户界面
- [ ] 首页布局风格？（卡片式/列表式/仪表盘式）
- [ ] 主题色系偏好？（支持深色模式？）
- [ ] 导航方式？（底部导航/侧边栏/标签页）

### 5.2 积分规则
- [ ] 初始积分是多少？（默认0还是赠送初始积分？）
- [ ] 积分是否可以为负数？
- [ ] 重复任务（每日/每周等）是否有连续完成奖励？
- [ ] 是否需要积分等级/称号系统？

### 5.3 任务管理
- [ ] 任务是否支持子任务？
- [ ] 是否需要任务标签系统？
- [ ] 过期任务是否自动失败并扣分？
- [ ] 是否需要任务模板功能？
- [ ] 是否需要任务进度追踪（如：0-100%）？

### 5.4 数据与统计
- [ ] 是否需要数据导出功能？
- [ ] 是否需要图表展示积分趋势？
- [ ] 统计维度的需求？（按项目/按时间/按类型）
- [ ] 是否需要目标设定功能？（如：本月目标1000分）

### 5.5 其他功能
- [ ] 是否需要数据备份与恢复？
- [ ] 是否需要密码保护/指纹解锁？
- [ ] 是否需要每日签到功能？
- [ ] 是否需要成就系统？
- [ ] 是否考虑后期支持多用户/数据同步？

## 6. 开发计划建议

### Phase 1: MVP（最小可行产品）
1. 基础UI框架搭建
2. SQLite数据库集成
3. 积分展示与手动调整
4. 基础任务创建、完成、删除
5. 简单的积分记录查看

### Phase 2: 完善核心功能
1. 项目管理功能
2. 重复任务支持
3. 积分统计与历史记录
4. 奖励兑换系统

### Phase 3: 优化与扩展
1. 数据统计图表
2. 通知提醒
3. 主题切换
4. 数据导入导出

---

**备注**: 本文档为初稿，请根据实际需求讨论并修改各项功能细节。
